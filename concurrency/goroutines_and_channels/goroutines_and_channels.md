# Concurrency –≤ Go: Goroutines –∏ Channels

Go –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—â–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å—é: **goroutines** –∏ **channels**. –≠—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞—á–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±–º–µ–Ω–∏–≤–∞—Ç—å—Å—è –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏.

---

## Goroutines

**Goroutine** ‚Äî —ç—Ç–æ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –ø–æ—Ç–æ–∫, —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π Go-—Ä–∞–Ω—Ç–∞–π–º–æ–º. Goroutines –ø–æ–∑–≤–æ–ª—è—é—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ.

### –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å goroutine?

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π goroutine –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `go`:

```go
package main

import (
	"fmt"
	"time"
)

func printNumbers() {
	for i := 1; i <= 5; i++ {
		fmt.Println(i)
		time.Sleep(500 * time.Millisecond)
	}
}

func main() {
	go printNumbers() // –ó–∞–ø—É—Å–∫ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ goroutine
	time.Sleep(2 * time.Second) // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è goroutine
	fmt.Println("Main function")
}
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ goroutines:
- –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ: —Ç—ã—Å—è—á–∏ goroutines –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
- –£–ø—Ä–∞–≤–ª—è—é—Ç—Å—è Go-—Ä–∞–Ω—Ç–∞–π–º–æ–º, –∞ –Ω–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π.
- –ó–∞–≤–µ—Ä—à–∞—é—Ç—Å—è, –∫–æ–≥–¥–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ (—Ñ—É–Ω–∫—Ü–∏—è `main`).

---

## Channels

**Channel** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É goroutines. –ö–∞–Ω–∞–ª—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ goroutines.

### –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–Ω–∞–ª?

–ö–∞–Ω–∞–ª—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ `make` –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –±—É—Ñ–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–±—É—Ñ–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏.

#### –ù–µ–±—É—Ñ–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª:
```go
package main

import "fmt"

func main() {
	ch := make(chan int) // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–±—É—Ñ–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞

	go func() {
		ch <- 42 // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–∞–Ω–∞–ª
	}()

	value := <-ch // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫–∞–Ω–∞–ª–∞
	fmt.Println(value) // Output: 42
}
```

#### –ë—É—Ñ–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª:
```go
package main

import "fmt"

func main() {
	ch := make(chan int, 2) // –°–æ–∑–¥–∞–Ω–∏–µ –±—É—Ñ–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ —Å —Ä–∞–∑–º–µ—Ä–æ–º –±—É—Ñ–µ—Ä–∞ 2

	ch <- 1
	ch <- 2

	fmt.Println(<-ch) // Output: 1
	fmt.Println(<-ch) // Output: 2
}
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–∞–Ω–∞–ª–æ–≤:
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–∏—Ä—É—é—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –ø–æ–∫–∞ –¥–∞–Ω–Ω—ã–µ –Ω–µ –±—É–¥—É—Ç –ø–µ—Ä–µ–¥–∞–Ω—ã.
- –ó–∞–∫—Ä—ã—Ç–∏–µ –∫–∞–Ω–∞–ª–∞: `close(ch)`.
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏–µ –∫–∞–Ω–∞–ª–∞:
  ```go
  value, ok := <-ch
  if !ok {
      fmt.Println("Channel closed")
  }
  ```

---


## Select: –†–∞–±–æ—Ç–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏

**`select`** ‚Äî —ç—Ç–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç goroutine –æ–∂–∏–¥–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–π –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∫–∞–Ω–∞–ª–∞–º–∏. –û–Ω–∞ –ø–æ—Ö–æ–∂–∞ –Ω–∞ `switch`, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤.

### –û—Å–Ω–æ–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `select`

```go
package main

import (
	"fmt"
	"time"
)

func main() {
	ch1 := make(chan string)
	ch2 := make(chan string)

	go func() {
		time.Sleep(1 * time.Second)
		ch1 <- "Hello from ch1"
	}()

	go func() {
		time.Sleep(2 * time.Second)
		ch2 <- "Hello from ch2"
	}()

	select {
	case msg1 := <-ch1:
		fmt.Println(msg1)
	case msg2 := <-ch2:
		fmt.Println(msg2)
	case <-time.After(3 * time.Second): // –¢–∞–π–º–∞—É—Ç
		fmt.Println("Timeout")
	}
}
```

### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:
1. **`select`** –æ–∂–∏–¥–∞–µ—Ç, –ø–æ–∫–∞ –æ–¥–Ω–∞ –∏–∑ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∫–∞–Ω–∞–ª–∞–º–∏ (`ch1` –∏–ª–∏ `ch2`) –Ω–µ —Å—Ç–∞–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–π.
2. –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π, `select` –≤—ã–±–∏—Ä–∞–µ—Ç –æ–¥–Ω—É –∏–∑ –Ω–∏—Ö —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º.
3. **`time.After`** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–∞–π–º–∞—É—Ç–∞. –ï—Å–ª–∏ –Ω–∏ –æ–¥–∏–Ω –∫–∞–Ω–∞–ª –Ω–µ –≥–æ—Ç–æ–≤ –≤ —Ç–µ—á–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤–µ—Ç–∫–∞ `time.After`.


### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ select

- **`select`** –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `select` –¥–ª—è:
   - –û–∂–∏–¥–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤.
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–π–º–∞—É—Ç–æ–≤.
   - –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∫–∞–Ω–∞–ª–∞–º–∏.
   - –û—Å—Ç–∞–Ω–æ–≤–∫–∏ goroutines.

`select` ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å—é –≤ Go, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –±–æ–ª–µ–µ –≥–∏–±–∫–∏–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º. 

---

# –ó–∞–∫—Ä—ã—Ç–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –≤ Go: `close`

–í Go –∫–∞–Ω–∞–ª—ã –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ **`close`**. –ó–∞–∫—Ä—ã—Ç–∏–µ –∫–∞–Ω–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

---

## –ö–∞–∫ –∑–∞–∫—Ä—ã—Ç—å –∫–∞–Ω–∞–ª?

–î–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –∫–∞–Ω–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `close`:

```go
ch := make(chan int)
close(ch)
```

---

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –∫–∞–Ω–∞–ª–æ–≤

1. **–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–∞–Ω–∞–ª**:
   - –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–∞–Ω–∞–ª –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø–∞–Ω–∏–∫–∞ (`panic`).

   ```go
   ch := make(chan int)
   close(ch)
   ch <- 42 // panic: send on closed channel
   ```

2. **–ß—Ç–µ–Ω–∏–µ –∏–∑ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∫–∞–Ω–∞–ª–∞**:
   - –ï—Å–ª–∏ –∫–∞–Ω–∞–ª –∑–∞–∫—Ä—ã—Ç, —á—Ç–µ–Ω–∏–µ –∏–∑ –Ω–µ–≥–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ `false` –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ç–æ—Ä–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.

   ```go
   ch := make(chan int)
   close(ch)
   value, ok := <-ch
   fmt.Println(value, ok) // 0, false
   ```

3. **–ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –∫–∞–Ω–∞–ª—É**:
   - –ï—Å–ª–∏ –∫–∞–Ω–∞–ª –∑–∞–∫—Ä—ã—Ç, —Ü–∏–∫–ª `for range` –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

   ```go
   ch := make(chan int, 3)
   ch <- 1
   ch <- 2
   close(ch)

   for value := range ch {
       fmt.Println(value) // 1, 2
   }
   ```

### –∏—Ç–æ–≥–∏ close

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `close`, —á—Ç–æ–±—ã —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –∫–∞–Ω–∞–ª–æ–º.
- –ó–∞–∫—Ä—ã—Ç–∏–µ –∫–∞–Ω–∞–ª–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–∞–ª—å–Ω–µ–π—à—É—é –æ—Ç–ø—Ä–∞–≤–∫—É –¥–∞–Ω–Ω—ã—Ö.
- –ß—Ç–µ–Ω–∏–µ –∏–∑ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ `false`.

–ó–∞–∫—Ä—ã—Ç–∏–µ –∫–∞–Ω–∞–ª–æ–≤ ‚Äî —ç—Ç–æ –≤–∞–∂–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º goroutines –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ Go.

---

## GOMAXPROCS: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ

Go –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å** –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è goroutines. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `runtime.GOMAXPROCS`.

### –ß—Ç–æ —Ç–∞–∫–æ–µ `GOMAXPROCS`?

- `GOMAXPROCS` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `GOMAXPROCS` —Ä–∞–≤–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —è–¥–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (`runtime.NumCPU()`).
- –í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é `runtime.GOMAXPROCS(n)`.

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `GOMAXPROCS`:

```go
package main

import (
	"fmt"
	"runtime"
	"testing"
	"time"
)

func TestGoMaxProc(t *testing.T) {
	runtime.GOMAXPROCS(1) // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤
	fmt.Println("CPU cores:", runtime.NumCPU())
	fmt.Println("GOMAXPROCS:", runtime.GOMAXPROCS(0))

	for i := 0; i < 10; i++ {
		go func(num int) {
			fmt.Println("start", num)

			// —Ç–æ—á–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≥–æ—Ä—É—Ç–∏–Ω
			time.Sleep(1 * time.Millisecond)
			fmt.Println("stop", num)
		}(i)
	}

	time.Sleep(1 * time.Second) // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è goroutines
}
```

### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:
1. **`runtime.GOMAXPROCS(1)`**:
    - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, —Ä–∞–≤–Ω—ã–º 1.
    - –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–∞–∂–µ –µ—Å–ª–∏ —É –≤–∞—Å –±–æ–ª—å—à–µ —è–¥–µ—Ä, Go –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ 1 –ø–æ—Ç–æ–∫.

2. **`runtime.NumCPU()`**:
    - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.

3. **`runtime.GOMAXPROCS(0)`**:
    - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `GOMAXPROCS`.

4. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**:
    - –î–∞–∂–µ –µ—Å–ª–∏ `GOMAXPROCS` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ 1, Go –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É goroutines –Ω–∞ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ, —Å–æ–∑–¥–∞–≤–∞—è –∏–ª–ª—é–∑–∏—é –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

5. **`time.Sleep`**:
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è goroutines. –í —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sync.WaitGroup`.

---

## –ü—Ä–∏–º–µ—Ä: Worker Pool

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ goroutines –∏ –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—É–ª–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤:

```go
package main

import (
	"fmt"
	"time"
)

func worker(id int, jobs <-chan int, results chan<- int) {
	for job := range jobs {
		fmt.Printf("Worker %d started job %d\n", id, job)
		time.Sleep(time.Second) // –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
		results <- job * 2
		fmt.Printf("Worker %d finished job %d\n", id, job)
	}
}

func main() {
	jobs := make(chan int, 10)
	results := make(chan int, 10)

	// –ó–∞–ø—É—Å–∫ 3 –≤–æ—Ä–∫–µ—Ä–æ–≤
	for w := 1; w <= 3; w++ {
		go worker(w, jobs, results)
	}

	// –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–¥–∞—á
	for j := 1; j <= 5; j++ {
		jobs <- j
	}
	close(jobs)

	// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
	for a := 1; a <= 5; a++ {
		fmt.Println("Result:", <-results)
	}
}
```

---

## –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–î–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ goroutines –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- –ö–∞–Ω–∞–ª—ã.
- –ü—Ä–∏–º–∏—Ç–∏–≤—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏–∑ –ø–∞–∫–µ—Ç–∞ `sync` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `sync.WaitGroup`).

### –ü—Ä–∏–º–µ—Ä —Å `sync.WaitGroup`:

```go
package main

import (
	"fmt"
	"sync"
)

func worker(id int, wg *sync.WaitGroup) {
	defer wg.Done() // –£–º–µ–Ω—å—à–∞–µ–º —Å—á–µ—Ç—á–∏–∫ WaitGroup
	fmt.Printf("Worker %d starting\n", id)
	// –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
	fmt.Printf("Worker %d done\n", id)
}

func main() {
	var wg sync.WaitGroup

	for i := 1; i <= 5; i++ {
		wg.Add(1) // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ WaitGroup
		go worker(i, &wg)
	}

	wg.Wait() // –û–∂–∏–¥–∞–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö goroutines
	fmt.Println("All workers done")
}
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

- **Goroutines** –ø–æ–∑–≤–æ–ª—è—é—Ç –ª–µ–≥–∫–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏.
- **Channels** –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É goroutines.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `sync.WaitGroup` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è goroutines.
- **`GOMAXPROCS`** –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

Go –¥–µ–ª–∞–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –±–ª–∞–≥–æ–¥–∞—Ä—è goroutines, channels –∏ `GOMAXPROCS`. üöÄ
```

–¢–µ–ø–µ—Ä—å –∑–∞–º–µ—Ç–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ `GOMAXPROCS` –∏ –ø—Ä–∏–º–µ—Ä–µ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ.