# Логирование в Go

## Основные концепции

### 1. Что такое логирование?
- Это процесс записи событий, происходящих во время работы программы.
- Используется для отладки, мониторинга, аудита и диагностики ошибок.

### 2. Зачем логирование?
- Упрощает отладку и выявление ошибок.
- Позволяет понять поведение приложения в продакшене.
- Логи можно обрабатывать автоматически (поиск, визуализация, алерты).

---

## Базовое логирование (пакет `log`)

### 1. Использование `log`
```go
import "log"

func main() {
    log.Println("Инфо сообщение")
    log.Fatalln("Критическая ошибка") // завершает программу
    log.Panicln("Паника")             // вызывает panic
}
```

### 2. Настройка префикса и формата
```go
log.SetPrefix("APP: ")
log.SetFlags(log.Ldate | log.Ltime | log.Lshortfile)
log.Println("Сервис стартовал")
```

---

## Структурированные логи

### Что это?
- Каждое сообщение содержит не только текст, но и дополнительные поля (метаданные).
- Пример: время, уровень, ID запроса, HTTP статус и т.д.

### Зачем?
- Упрощает автоматическую обработку логов.
- Удобнее анализировать и фильтровать.

---

## Популярные библиотеки

### 1. `log/slog` (Go 1.21+)
- Новый стандарт логирования в Go.
- Поддерживает структурированные логи.
- Использует контекст, уровни и формат JSON.

```go
import (
    "log/slog"
    "os"
)

func main() {
    logger := slog.New(slog.NewJSONHandler(os.Stdout, nil))
    logger.Info("Запуск сервиса", "version", "1.0", "env", "prod")
}
```

- Уровни: `Debug`, `Info`, `Warn`, `Error`.

---

### 2. `zap` (uber-go/zap)
- Высокопроизводительная библиотека от Uber.
- Быстрая, минимальный overhead.

```go
logger, _ := zap.NewProduction()
defer logger.Sync()

logger.Info("Старт", zap.String("env", "prod"), zap.Int("version", 2))
```

- Поддерживает логирование в JSON, структуры, поля с типами.

---

### 3. `logrus` (sirupsen/logrus)
- Старейшая и популярная библиотека.
- Прост в использовании, поддерживает хуки, уровни и форматирование.

```go
import log "github.com/sirupsen/logrus"

func main() {
    log.SetFormatter(&log.JSONFormatter{})
    log.WithFields(log.Fields{
        "user_id": 42,
        "event":   "login",
    }).Info("User event")
}
```

---

## Практические советы

- Используйте структурированные логи.
- Определите уровни логов (debug, info, warn, error).
- Логируйте ключевые события: старт/остановка приложения, ошибки, внешние вызовы.
- Не логируйте чувствительные данные (пароли, токены).
- Разделяйте конфигурацию логгера (формат, уровень, вывод).

