# Пакет `io` в GO

## Основные концепции

### 1. Абстракция ввода-вывода
- **Проблема**: Устройств ввода-вывода много (файлы, сеть, память и т.д.), и у каждого свои особенности.
- **Решение**: Go предоставляет интерфейсы (`io.Reader`, `io.Writer` и др.), которые абстрагируют операции ввода-вывода. Это позволяет писать код, не зависящий от конкретного устройства.

### 2. Dependency Injection (DI)
- Интерфейсы `io` позволяют внедрять зависимости (например, передавать любой источник данных, реализующий `io.Reader`).

---

## Основные интерфейсы пакета `io`

### 1. `io.Reader`
```go
type Reader interface {
    Read(p []byte) (n int, err error)
}
```
- **Назначение**: Чтение данных из источника.
- **Особенности**:
    - Заполняет переданный буфер `p`.
    - Возвращает количество прочитанных байт `n` и ошибку `err`.
    - `io.EOF` — специальная ошибка, означающая конец данных.

### 2. `io.Writer`
```go
type Writer interface {
    Write(p []byte) (n int, err error)
}
```
- **Назначение**: Запись данных в приемник.
- **Особенности**:
    - Записывает данные из буфера `p`.
    - Возвращает количество записанных байт `n` и ошибку `err`.

### 3. `io.Closer`
```go
type Closer interface {
    Close() error
}
```
- **Назначение**: Освобождение ресурсов (например, закрытие файла) (вручную).
- **Особенности**:
    - Close следует вызывать как можно раньше.
    - Забытый Close - причина утечки ресурсов
- **Важно**:
    - Всегда вызывайте `Close()` для объектов, реализующих этот интерфейс.
    - Не забывайте обрабатывать ошибки

### 4. `io.Seeker`
```go
type Seeker interface {
    Seek(offset int64, whence int) (int64, error)
}
```
- **Назначение**: Произвольный доступ к данным (перемещение по файлу).
- **Параметры**:
    - `whence`: `io.SeekStart`, `io.SeekCurrent`, `io.SeekEnd`.

### 5. Комбинированные интерфейсы
- Например, `io.ReadCloser` (чтение + закрытие):
  ```go
  type ReadCloser interface {
      Reader
      Closer
  }
  ```

---

## Утилиты пакета `io`

### 1. Объединение потоков
- `io.MultiReader`: Чтение из нескольких источников последовательно.
- `io.MultiWriter`: Запись в несколько приемников одновременно.

### 2. Ограничение чтения
- `io.LimitReader`: Чтение не более `N` байт.

### 3. Буферизация (`bufio`)
- Уменьшает количество системных вызовов для мелких операций:
  ```go
  file, _ := os.Open("file.txt")
  reader := bufio.NewReader(file)
  line, _ := reader.ReadString('\n') // чтение по строкам
  ```

---

## Итог
- Интерфейсы `io` предоставляют унифицированный способ работы с разными устройствами ввода-вывода.
- Используйте комбинированные интерфейсы (`ReadCloser`, `ReadWriteSeeker`) для сложных задач.
- Всегда закрывайте ресурсы (`Closer`) и обрабатывайте ошибки.
- Буферизация (`bufio`) и утилиты (`io.Copy`, `MultiReader`) упрощают код и улучшают производительность.
